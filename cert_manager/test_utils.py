"""Tests for the functions in the utils module."""

from .utils import extract_x509_dns_names

PEM_DATA = """-----BEGIN CERTIFICATE-----
MIIGsDCCBZigAwIBAgISA15nSmVNdB60HzJjz+jsoMXKMA0GCSqGSIb3DQEBCwUA
MEoxCzAJBgNVBAYTAlVTMRYwFAYDVQQKEw1MZXQncyBFbmNyeXB0MSMwIQYDVQQD
ExpMZXQncyBFbmNyeXB0IEF1dGhvcml0eSBYMzAeFw0xODA4MjEyMzQyMTRaFw0x
ODExMTkyMzQyMTRaMCQxIjAgBgNVBAMTGWNvdXJzZXMub3BlbmNyYWZ0Lmhvc3Rp
bmcwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDOIEjGkYo3dA5QEcV0
xpywqMaT7lOwVpMzwzznOTQ10AODSU4yTKXh5LVpuh+s6mo/w0ZUa7VOE1tRQh1K
RzQ/CW6WXRGi81XPpWd9wUPCwgo/zLBsoL4DXfmL3N/MQiTGnvP01jRjfmDReGAv
GfOfAbrI53jQw2IgCvp8wikgM2W5zmrzE1oZsVHrj4b2RJ4L6SQAoYFB92dRQ/O5
6YSmZneqqiDjL6VW9itImOfLWrPWEN1+rmWonA1059YU5tQayYuvgBS7O4LceRUa
b4vN51dNUIHMa7poDZGG3mYUJgKunWgBKSUaGsHfMzzcbH45YrnD6VFErU72zne9
1t+vAgMBAAGjggO0MIIDsDAOBgNVHQ8BAf8EBAMCBaAwHQYDVR0lBBYwFAYIKwYB
BQUHAwEGCCsGAQUFBwMCMAwGA1UdEwEB/wQCMAAwHQYDVR0OBBYEFIRd+rTsFYMj
UhqT7eXO6I0Y21IMMB8GA1UdIwQYMBaAFKhKamMEfd265tE5t6ZFZe/zqOyhMG8G
CCsGAQUFBwEBBGMwYTAuBggrBgEFBQcwAYYiaHR0cDovL29jc3AuaW50LXgzLmxl
dHNlbmNyeXB0Lm9yZzAvBggrBgEFBQcwAoYjaHR0cDovL2NlcnQuaW50LXgzLmxl
dHNlbmNyeXB0Lm9yZy8wgbUGA1UdEQSBrTCBqoIZY291cnNlcy5vcGVuY3JhZnQu
aG9zdGluZ4IjZGlzY292ZXJ5LWNvdXJzZXMub3BlbmNyYWZ0Lmhvc3RpbmeCI2Vj
b21tZXJjZS1jb3Vyc2VzLm9wZW5jcmFmdC5ob3N0aW5ngiFwcmV2aWV3LWNvdXJz
ZXMub3BlbmNyYWZ0Lmhvc3RpbmeCIHN0dWRpby1jb3Vyc2VzLm9wZW5jcmFmdC5o
b3N0aW5nMIH+BgNVHSAEgfYwgfMwCAYGZ4EMAQIBMIHmBgsrBgEEAYLfEwEBATCB
1jAmBggrBgEFBQcCARYaaHR0cDovL2Nwcy5sZXRzZW5jcnlwdC5vcmcwgasGCCsG
AQUFBwICMIGeDIGbVGhpcyBDZXJ0aWZpY2F0ZSBtYXkgb25seSBiZSByZWxpZWQg
dXBvbiBieSBSZWx5aW5nIFBhcnRpZXMgYW5kIG9ubHkgaW4gYWNjb3JkYW5jZSB3
aXRoIHRoZSBDZXJ0aWZpY2F0ZSBQb2xpY3kgZm91bmQgYXQgaHR0cHM6Ly9sZXRz
ZW5jcnlwdC5vcmcvcmVwb3NpdG9yeS8wggEFBgorBgEEAdZ5AgQCBIH2BIHzAPEA
dwDBFkrgp3LS1DktyArBB3DU8MSb3pkaSEDB+gdRZPYzYAAAAWVfFPhKAAAEAwBI
MEYCIQDcqG67P+fP/o2C3A5FGQWPjFgtRNKq1lI7IOnW0KVNPwIhAKHB1oJYgm8O
/+JgqrcCaqZhCUDriaEIscb4b9Ud7PLBAHYAKTxRllTIOWW6qlD8WAfUt2+/WHop
ctykwwz05UVH9HgAAAFlXxT6VwAABAMARzBFAiAfdRiSl4W8NDZFSDZ/krtTKNHd
8tQ1NTMTJhmp0ioFAgIhANdtMGwylOkvZIBj5jE7lpVgPPKOHg5vLsuWE9sXV9hg
MA0GCSqGSIb3DQEBCwUAA4IBAQA3EkjsBmAvluMQjQPZXDpVnL71tMw1v+l8G+uK
aANIp3H0lzaduP4B7+gIi0O8HnypAASFXVpLnXjlPGjjc7QDMnCihhWhmIWOjMjs
IrxDQdFg89b4ByjpnKTMdEV8aSM9g3tqelzy6ltPIZHNw6l6YTLJsj/B89m8sya5
tL/sXtI4amH+094MDuyBKm7YBZ6gJCOxbLZjlHSEYVrWqK+wZTlLGPJlKvFlnWiy
oUalStG4tAF4ILIFKBFwYtjnZsPNBHC/Yj6vtkvBF7nEfCPD9OSV6iU8Ng4qMsdR
Q+stWwG0LEfySAaAclDHlG3GX1QicEh9dStyABzKO1MfJwBY
-----END CERTIFICATE-----
"""


def test_extract_x509_dns_names():
    """Test extracting DNS names from a PEM certificate."""
    assert set(extract_x509_dns_names(PEM_DATA)) == set([
        "courses.opencraft.hosting",
        "discovery-courses.opencraft.hosting",
        "ecommerce-courses.opencraft.hosting",
        "preview-courses.opencraft.hosting",
        "studio-courses.opencraft.hosting",
    ])
